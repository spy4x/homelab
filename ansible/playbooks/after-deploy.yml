---
# After Deploy Playbook
# This playbook runs post-deployment configuration that depends on deployed services
# It configures service-specific monitoring, backups, and security

- name: After Deploy Configuration
  hosts: homelab_servers

  tasks:
    - name: Welcome message
      ansible.builtin.debug:
        msg:
          - "ðŸš€ Starting Post-Deployment Configuration"
          - "Target: {{ inventory_hostname }}"
          - "User: {{ homelab_user }}"

# Import all after-deploy playbooks in order
- import_playbook: after-deploy/fail2ban.yml
- import_playbook: after-deploy/monitoring.yml
- import_playbook: after-deploy/backup-cronjob.yml
- import_playbook: after-deploy/radicale-setup.yml

- name: After Deploy Complete
  hosts: homelab_servers
  tasks:
    - name: Configuration summary
      ansible.builtin.debug:
        msg:
          - "âœ… Post-deployment configuration completed!"
          - ""
          - "Configured components:"
          - "  âœ“ Fail2ban (SSH + Docker logs protection)"
          - "  âœ“ Container health monitoring"
          - "  âœ“ Automated backups via cron"
          - "  âœ“ Radicale user accounts (if applicable)"
          - ""
          - "ðŸŽ‰ Your homelab is fully configured and secured!"
          - ""
          - "All services are monitored, backed up, and protected."
