---
# Main Initial Setup Playbook
# This playbook handles complete fresh server setup after OS installation
# It installs essential tools, configures security, and sets up monitoring

- name: Initial Server Setup - Complete Configuration
  hosts: homelab_servers

  tasks:
    - name: Welcome message
      ansible.builtin.debug:
        msg:
          - "ðŸ”§ Starting Initial Server Setup"
          - "Target: {{ inventory_hostname }}"
          - "User: {{ homelab_user }}"

# Import all initial setup playbooks in order
- import_playbook: initial-setup/base.yml
- import_playbook: initial-setup/ssh-hardening.yml
- import_playbook: initial-setup/smart-monitoring.yml
- import_playbook: initial-setup/maintenance.yml

- name: Initial Setup Complete
  hosts: homelab_servers
  tasks:
    - name: Setup summary
      ansible.builtin.debug:
        msg:
          - "âœ… Initial server setup completed!"
          - ""
          - "Configured components:"
          - "  âœ“ Docker and Docker Compose"
          - "  âœ“ Deno runtime"
          - "  âœ“ SSH hardening (key-only auth)"
          - "  âœ“ SMART monitoring (SSD/NVMe health)"
          - "  âœ“ System maintenance (updates, cleanup, log rotation)"
          - ""
          - "ðŸŽ¯ Server is ready for service deployment!"
          - ""
          - "Next step: Deploy services with ansible-playbook playbooks/deploy.yml"
